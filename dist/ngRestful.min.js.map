{"version":3,"sources":["module.js","services/resource.js","services/restful.js"],"names":["ngRestful","angular","module","config","$http","defaults","useXDomain","constant","$domain","$headers","setDomain","value","this","setHeader","key","factory","$restful","$globals","resource","url","isString","Error","isAbsolute","$url","join","$config","match","setParams","uri","params","p","replace","prototype","fetch","path","Object","toString","call","http","get","save","data","post","update","put","delete","service","$createRequest","method","$normalizeConfig","request","assign","headers","hasFileObject","form","FormData","prop","append","undefined","identity","ignoreProps","obj","forEach","el","hasOwnProperty"],"mappings":"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","file":"ngRestful.min.js","sourcesContent":["var ngRestful = angular.module(\"ngRestful\", []);\n\nngRestful.config([\"$httpProvider\", function($http){\n\t// Enable CORS response\n\t$http.defaults.useXDomain = true;\n}]);\n\n/*\n * Define constant configuration for the module\n */\nngRestful.constant(\"ngRestful\", {\n\t$domain: \"\",\n\t$headers: {},\n\tsetDomain: function(value){\n\t\tthis.$domain = value;\n\t},\n\tsetHeader: function(key, value){\n\t\tthis.$headers[key] = value;\n\t}\n});","ngRestful.factory(\"$resource\", [\"$restful\", \"ngRestful\", function($restful, $globals){\n\t/**\n\t * Construct function of resource object\n\t * Defines the common settings for the resource\n\t * \n\t * @param  {String} url  The URL of the host API\n\t * @param  {Object} config The options settings to set in the resource\n\t */\n\tfunction resource(url, config){\n\t\tif(typeof url != \"undefined\" && !angular.isString(url)){\n\t\t\tthrow new Error(\"url in constructor is not a valid value.\");\n\t\t}\n\n\t\telse{\n\t\t\tif($globals.$domain && !isAbsolute(url)){\n\t\t\t\tthis.$url = [$globals.$domain, url].join(\"/\");\n\t\t\t}\n\n\t\t\telse{\n\t\t\t\tthis.$url = url;\n\t\t\t}\n\t\t}\n\n\t\tthis.$config = config || {};\n\t}\n\n\t/**\n\t * Checks if a provided url is absolute\n\t * \n\t * @param  {String}  url The provided url to evaluate\n\t * @return {Boolean}     Whether the url is absolute\n\t */\n\tfunction isAbsolute(url){\n\t\tvar regex = /^(https:\\/\\/|http:\\/\\/|\\/\\/).+/g;\n\n\t\treturn url.match(regex) !== null;\n\t}\n\n\t/**\n\t * Fetches a collection list from the resource\n\t * \n\t * @param  {String|Array}  path The resource path of the host\n\t * @return {Promise}            The response from the host\n\t */\n\tresource.prototype.fetch = function(path){\n\t\tif(path && Object.prototype.toString.call(path) == \"[object Array]\"){\n\t\t\tpath = setParams(path[0], path[1])\n\t\t}\n\n\t\tvar http = path ? [this.$url, path].join(\"/\") : this.$url;\n\n\t\treturn $restful.get(http, this.$config);\n\t};\n\n\t/**\n\t * Sends data to a resource uri with POST method\n\t * \n\t * @param  {String|Array} path The path of the host\n\t * @param  {Object}       data The data to send to the resource\n\t * @return {Promise}           The response from the host\n\t */\n\tresource.prototype.save = function(path, data){\n\t\tif(path && Object.prototype.toString.call(path) == \"[object Array]\"){\n\t\t\tpath = setParams(path[0], path[1])\n\t\t}\n\t\n\t\tvar http = path ? [this.$url, path].join(\"/\") : this.$url;\n\t\t\n\t\treturn $restful.post(http, data, this.$config);\n\t};\n\n\t/**\n\t * Sends data to a resource uri with PUT method\n\t * \n\t * @param  {String|Array} path The path of the host\n\t * @param  {Object}       data The data to send to the resource\n\t * @return {Promise}           The response from the host\n\t */\n\tresource.prototype.update = function(path, data) {\n\t\tif(path && Object.prototype.toString.call(path) == \"[object Array]\"){\n\t\t\tpath = setParams(path[0], path[1])\n\t\t}\n\t\n\t\tvar http = path ? [this.$url, path].join(\"/\") : this.$url;\n\n\t\treturn $restful.put(http, data, this.$config);\n\t};\n\n\t/**\n\t * Sends a request with data to a resource uri with DELETE method\n\t * \n\t * @param  {String|Array} path The path of the host\n\t * @param  {Object}       data The data to send to the resource\n\t * @return {Promise}           The response from the host\n\t */\n\tresource.prototype.delete = function(path, data) {\n\t\tif(path && Object.prototype.toString.call(path) == \"[object Array]\"){\n\t\t\tpath = setParams(path[0], path[1])\n\t\t}\n\t\n\t\tvar http = path ? [this.$url, path].join(\"/\") : this.$url;\n\n\t\treturn $restful.delete(http, data, this.$config);\n\t};\n\n\t/**\n\t * Sets uri parameters into the uri string\n\t * where key object is the parameter name and\n\t * value is the value to replace\n\t * \n\t * @param {String} uri    The uri with parameters to replace\n\t * @param {Object} params The map of parameters to set into uri\n\t */\n\tfunction setParams(uri, params){\n\t\tfor(p in params){\n\t\t\turi = uri.replace(\":\" + p, params[p]);\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\treturn resource;\n}]);","ngRestful.service(\"$restful\", [\"$http\", \"ngRestful\", function($http, $globals){\n\t/**\n\t * Performs a GET request to the host\n\t * \n\t * @param  {String}  url     The url path where to send the request\n\t * @param  {Object}  config  The config options to set in the request\n\t * @return {Promise}         The response from the host\n\t */\n\tthis.get = function(url, config){\n\t\treturn $http(this.$createRequest({}, \"GET\", url, config));\n\t};\n\n\t/**\n\t * Performs a POST request to the host\n\t * \n\t * @param  {String}  url     The url path where to send the request\n\t * @param  {Object}  data    The data to send along the request\n\t * @param  {Object}  config  The config options to set in the request\n\t * @return {Promise}         The response from the host\n\t */\n\tthis.post = function(url, data, config){\n\t\treturn $http(this.$createRequest(data, \"POST\", url, config));\n\t};\n\n\t/**\n\t * Performs a PUT request to the host\n\t * \n\t * @param  {String}  url     The url path where to send the request\n\t * @param  {Object}  data    The data to send along the request\n\t * @param  {Object}  config  The config options to set in the request\n\t * @return {Promise}         The response from the host\n\t */\n\tthis.put = function(url, data, config){\n\t\treturn $http(this.$createRequest(data, \"PUT\", url, config));\n\t};\n\n\t/**\n\t * Performs a DELETE request to the host\n\t * \n\t * @param  {String}  url     The url path where to send the request\n\t * @param  {Object}  data    The data to send along the request\n\t * @param  {Object}  config  The config options to set in the request\n\t * @return {Promise}         The response from the host\n\t */\n\tthis.delete = function(url, data, config){\n\t\treturn $http(this.$createRequest(data, \"DELETE\", url, config));\n\t};\n\n\t/**\n\t * Creates a request object for $http, the returned object can vary if\n\t * the data has a file object, if that's the case then content-type is set\n\t * to undefined in order to let the browser handle it\n\t * \n\t * @param  {Object} data    The data that will be sent to the host\n\t * @param  {String} method  The method on which will be used for the request\n\t * @param  {String} url     The url where to send the request\n\t * @param  {Object} config  The object mapped with request config\n\t * @return {Object}         The object for $http\n\t */\n\tthis.$createRequest = function(data, method, url, config){\n\t\tconfig = this.$normalizeConfig(config);\n\n\t\tvar request = {\n\t\t\turl: url,\n\t\t\tmethod: method,\n\t\t\tdata: data\n\t\t};\n\n\t\t// Merge config data into request object\n\t\tObject.assign(request, config);\n\n\t\t// Check if headers is defined, if otherwise then create object\n\t\tif(typeof request.headers == \"undefined\"){\n\t\t\trequest.headers = {};\n\t\t}\n\t\t\n\t\t// Merge default headers into header request object\n\t\tObject.assign(request.headers, $globals.$headers);\n\n\t\t// Create custom object for attached files\n\t\tif(method != \"GET\" && this.hasFileObject(data)){\n\t\t\tvar form = new FormData();\n\n\t\t\tfor(prop in data){\n\t\t\t\tform.append(prop, data[prop]);\n\t\t\t}\n\n\t\t\t// let the broswer handle the content-type request\n\t\t\trequest.headers[\"Content-Type\"] = undefined;\n\n\t\t\t// Set the data for request with attached files\n\t\t\trequest[\"data\"] = form;\n\t\t\trequest[\"transformRequest\"] = angular.identity;\n\t\t}\n\n\t\treturn request;\n\t}\n\n\t/**\n\t * Checks if the object data has a file object\n\t * \n\t * @param  {Object}  data The data where to find\n\t * @return {Boolean}      Whether the file was found\n\t */\n\tthis.hasFileObject = function(data){\n\t\tfor(prop in data){\n\t\t\tif(Object.prototype.toString.call(data[prop]) == \"[object File]\"){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Normalizes the config structure for $createRequest use\n\t * \n\t * @param  {Object} config The object to check and remove unecessary data\n\t * @return {Object}        The object to be used for request object\n\t */\n\tthis.$normalizeConfig = function(config){\n\t\tvar ignoreProps = [\"url\", \"method\", \"data\"\t];\n\n\t\tvar obj = config;\n\n\t\t// Remove all props with the name listed\n\t\tignoreProps.forEach(function(el){\n\t\t\tif(obj.hasOwnProperty(el)){\n\t\t\t\tdelete obj[el];\n\t\t\t}\n\t\t});\n\n\t\treturn obj;\n\t}\n}]);"]}